
::: {.panel-tabset .nav-pills}

### Clustering 

::: {.panel-tabset .nav-pills}

```{r}
#| label: global_proximity_per_marker_logratio
#| fig-height: 8
#| results: 'asis'

plots <- component_proximity_per_marker(proximity_scores, sample_palette = sample_palette, test_mode = params$test_mode)
tabset_plotlist(plots, level = 5)
```

:::

### Colocalization 
::: {.panel-tabset .nav-pills}

#### Global 

```{r}
#| label: coloc_global_summary
#| results: 'asis'
processed_data <- summarize_colocalization_scores_per_sample(proximity_scores, params$test_mode)
```

```{r}
#| label: coloc_global_summary_heatmap_logratio
#| fig-width: 14
#| fig-height: 10
#| results: 'asis'
plots <- component_proximity_heatmap_sample(processed_data, heatmap_gradient, "log2_ratio")
tabset_plotlist(plots, level = 5)
```



#### Per Celltype 

```{r}
#| label: coloc_celltype_summary
#| fig-width: 14
#| fig-height: 10
#| results: 'asis'
processed_data <- summarize_colocalization_scores_per_celltype(proximity_scores, params$test_mode)
```

```{r}
#| label: coloc_celltype_summary_heatmap_logratio
#| fig-width: 14
#| fig-height: 10
#| results: 'asis'
plots <- component_proximity_heatmap_celltype(processed_data, heatmap_gradient, "log2_ratio")
tabset_plotlist(plots, level = 5)
```

:::

:::
